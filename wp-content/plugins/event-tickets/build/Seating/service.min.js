!function(e){function t(t){for(var r,i,c=t[0],a=t[1],p=t[2],_=0,l=[];_<c.length;_++)i=c[_],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&l.push(o[i][0]),o[i]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(u&&u(t);l.length;)l.shift()();return s.push.apply(s,p||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,c=1;c<n.length;c++){var a=n[c];0!==o[a]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={17:0},s=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],a=c.push.bind(c);c.push=t,c=c.slice();for(var p=0;p<c.length;p++)t(c[p]);var u=a;s.push(["4dmZ",0]),n()}({"4dmZ":function(e,t,n){"use strict";n.r(t);var r=n("lSNA"),o=n.n(r),s=n("MsaN");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const{_x:a}=wp.i18n,p=a("Unknown error","Error message","event-tickets"),u={BAD_SERVICE_RESPONSE:Object(s.getLocalizedString)("bad-service-response","service-errors"),MISSING_REQUEST_PARAMETERS:Object(s.getLocalizedString)("missing-request-parameters","service-errors"),INVALID_SITE_PARAMETER:Object(s.getLocalizedString)("invalid-site-parameter","service-errors"),INVALID_EXPIRE_TIME_PARAMETER:Object(s.getLocalizedString)("invalid-expire-time-parameter","service-errors"),MISSING_EPHEMERAL_TOKEN:Object(s.getLocalizedString)("missing-ephemeral-token","service-errors"),SITE_NOT_FOUND:Object(s.getLocalizedString)("site-not-found","service-errors"),EPHEMERAL_TOKEN_STORE_ERROR:Object(s.getLocalizedString)("ephemeral-token-store-error","service-errors"),SITE_NOT_AUTHORIZED:Object(s.getLocalizedString)("site-not-authorized","service-errors")};function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(){return document.getElementById("tec-tickets-seating-notice")}function f(e){e&&(e.style.display="none",e.style.visibility="hidden")}function E(e){e&&(e.style.display="block",e.style.visibility="visible")}function g(e,t){if(!e)return;const n=e.classList;n.remove("notice-success"),n.remove("notice-warning"),n.remove("notice-error"),n.add(t)}function O(e,t){e&&(e.innerHTML="<p>"+t+"</p>")}window.tec=window.tec||{},window.tec.tickets.seating=window.tec.tickets.seating||{},window.tec.tickets.seating.service=window.tec.tickets.seating.service||{},window.tec.tickets.seating.service.errors=c(c({},window.tec.tickets.seating.service.errors||{}),{},{BAD_SERVICE_RESPONSE:"BAD_SERVICE_RESPONSE",MISSING_REQUEST_PARAMETERS:"MISSING_REQUEST_PARAMETERS",MISSING_EPHEMERAL_TOKEN:"MISSING_EPHEMERAL_TOKEN",INVALID_SITE_PARAMETER:"INVALID_SITE_PARAMETER",INVALID_EXPIRE_TIME_PARAMETER:"INVALID_EXPIRE_TIME_PARAMETER",SITE_NOT_FOUND:"SITE_NOT_FOUND",EPHEMERAL_TOKEN_STORE_ERROR:"EPHEMERAL_TOKEN_STORE_ERROR",SITE_NOT_AUTHORIZED:"SITE_NOT_AUTHORIZED",getErrorMessage:function(e){return u[e]||p}}),window.tec=window.tec||{},window.tec.tickets.seating=window.tec.tickets.seating||{},window.tec.tickets.seating.service=window.tec.tickets.seating.service||{},window.tec.tickets.seating.service.notices=l(l({},window.tec.tickets.seating.service.notices||{}),{},{notifyUserOfWarning:function(e){const t=d();f(t),g(t,"notice-warning"),O(t,e),E(t)},notifyUserOfError:function(e){const t=d();f(t),g(t,"notice-error"),O(t,e),E(t)}});var y=n("yXPU"),w=n.n(y);const m=window.tec.tickets.seating.service,v=m.baseUrl.replace(/\/$/,""),T=m.mapsHomeUrl.replace(/\/$/,""),b=m.layoutsHomeUrl.replace(/\/$/,""),S=m.associatedEventsUrl.replace(/\/$/,"");function h(){return v.split("?")[0]}var P=n("lL5a");function R(e){console.debug("Message received from service",e)}function A(){return(A=w()((function*(){const e=new URL(P.ajaxUrl);e.searchParams.set("_ajax_nonce",P.ajaxNonce),e.searchParams.set("action","tec_tickets_seating_service_invalidate_maps_layouts_cache");return 200===(yield fetch(e.toString(),{method:"POST"})).status||(console.error("Invalidation of maps and layouts cache failed, clean the transients manually to fetch up-to-date maps and layouts from the service."),!1)}))).apply(this,arguments)}function j(){return k.apply(this,arguments)}function k(){return(k=w()((function*(){const e=new URL(P.ajaxUrl);e.searchParams.set("_ajax_nonce",P.ajaxNonce),e.searchParams.set("action","tec_tickets_seating_service_invalidate_layouts_cache");return 200===(yield fetch(e.toString(),{method:"POST"})).status||(console.error("Invalidation of layouts cache failed, clean the transients manually to fetch up-to-date layouts from the service."),!1)}))).apply(this,arguments)}const I={default:R,app_postmessage_map_created_updated:function(){!function(){A.apply(this,arguments)}()},app_postmessage_layout_created_updated:function(){j()},app_postmessage_seat_type_created_updated:function(){j()},app_postmessage_goto_maps_home:function(){T?window.location.href=T:console.error("Maps home url not found")},app_postmessage_goto_layouts_home:function(){b?window.location.href=b:console.error("Layouts home url not found")}},N={ready:!1,establishingReadiness:!1,actionsMap:I,token:null};function D(e){return N.actionsMap[e]||N.actionsMap.default||R}function M(e,t){N.actionsMap[e]=t}function U(e){delete N.actionsMap[e]}function L(e){N.ready=e}function x(e){N.establishingReadiness=e}function V(){return N.token}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let z=[];function G(e,t,n){const r=e.closest("[data-token]").dataset.token;r?e.contentWindow.postMessage({action:t,token:r,data:n||null},h()):console.error("No token found in iframe element")}function C(){if(0===z.length)return;const[e,t,n]=z[0];(function(e){return function(){var t=w()((function*(t){yield e(t),z.shift(),C()}));return function(e){return t.apply(this,arguments)}}()})(t)(n.data.data)}function F(e){if(e.origin!==h()||!e.data.token||e.data.token!==V())return;const t=e.data.action;if(!t)return void console.error("No action found in message");const n=D(t);z.push([t,n,e]),z.length>1||C()}function K(e){const t=e.closest("[data-token]");if(!t)return void console.error("No token provider found in iframe element");const n=t.dataset.token;n?(!function(e){N.token=e}(n),window.addEventListener("message",F)):console.error("No token found in token provider element")}function Y(e){return $.apply(this,arguments)}function $(){return($=w()((function*(e){let t;K(e);const n=new Promise((n,o)=>{t=o;M("app_postmessage_ready",()=>{U("app_postmessage_ready"),L(!0),x(!1),G(e,"host_postmessage_ready"),clearTimeout(r),console.debug("Readiness established."),n()})}),r=setTimeout(()=>{t(new Error("Connection to service timed out"))},3e3);return e.src=e.dataset.src,n}))).apply(this,arguments)}window.tec=window.tec||{},window.tec.tickets.seating=window.tec.tickets.seating||{},window.tec.tickets.seating.service=window.tec.tickets.seating.service||{},window.tec.tickets.seating.service.api=B(B({},window.tec.tickets.seating.service.api||{}),{},{INBOUND_APP_READY:"app_postmessage_ready",INBOUND_APP_READY_FOR_DATA:"app_postmessage_ready_for_data",INBOUND_SEATS_SELECTED:"app_postmessage_seats_selected",INBOUND_SET_ELEMENT_HEIGHT:"app_postmessage_set_element_height",OUTBOUND_EVENT_ATTENDEES:"host_postmessage_event_attendees",OUTBOUND_HOST_READY:"host_postmessage_ready",OUTBOUND_REMOVE_RESERVATIONS:"host_postmessage_remove_reservations",OUTBOUND_SEAT_TYPE_TICKETS:"host_postmessage_seat_type_tickets",OUTBOUND_ATTENDEE_UPDATE:"host_postmessage_attendee_update",RESERVATIONS_DELETED:"app_postmessage_reservations_deleted",RESERVATIONS_UPDATED:"app_postmessage_reservations_updated",RESERVATIONS_UPDATED_FOLLOWING_SEAT_TYPES:"app_postmessage_reservations_updated_following_seat_types",SEAT_TYPES_UPDATED:"app_postmessage_seat_types_updated",SEAT_TYPE_DELETED:"app_postmessage_seat_type_deleted",GO_TO_ASSOCIATED_EVENTS:"app_postmessage_goto_associated_events",RESERVATION_UPDATED:"app_postmessage_reservation_updated",RESERVATION_CREATED:"app_postmessage_reservation_created",establishReadiness:Y,getHandlerForAction:D,getHandlerQueue:function(){return z},getRegisteredActions:function(){return N.actionsMap},getToken:V,registerAction:M,removeAction:U,sendPostMessage:G,startListeningForServiceMessages:K,getAssociatedEventsUrl:function(e){return e?`${S}&layout=${e}`:S}});var Z=n("Td2k");function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const{_x:W}=wp.i18n;function q(e){return J.apply(this,arguments)}function J(){return(J=w()((function*(e){if(!e)return!1;const t=e.closest(".tec-tickets-seating__iframe-container");if(!t)return!1;if(!t.dataset.token){const e=W("Ephemeral token not found in iframe element.","Error message","event-tickets"),n=t.dataset.error||e;return Object(Z.notifyUserOfError)(n),!1}return yield Y(e),!0}))).apply(this,arguments)}function ee(e){return(e=e||document).querySelector(".tec-tickets-seating__iframe-container iframe")}function te(){return(te=w()((function*(e){return yield q(e),e}))).apply(this,arguments)}window.tec=window.tec||{},window.tec.tickets.seating=window.tec.tickets.seating||{},window.tec.tickets.seating.service=window.tec.tickets.seating.service||{},window.tec.tickets.seating.service.iframe=X(X({},window.tec.tickets.seating.service.iframe||{}),{},{getIframeElement:ee,initServiceIframe:function(e){return te.apply(this,arguments)},handleResize:function(e,t){ee(t).style.height=e.height+"px"}})},MsaN:function(e,t){e.exports=tec.tickets.seating.utils},Td2k:function(e,t){e.exports=tec.tickets.seating.service.notices},lL5a:function(e,t){e.exports=tec.tickets.seating.ajax}});